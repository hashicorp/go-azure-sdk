package stable

import (
	"encoding/json"
	"fmt"
	"strings"
)

// Copyright (c) HashiCorp Inc. All rights reserved.
// Licensed under the MIT License. See NOTICE.txt in the project root for license information.

type WindowsMalwareCategory string

const (
	WindowsMalwareCategory_Adware                     WindowsMalwareCategory = "adware"
	WindowsMalwareCategory_AolExploit                 WindowsMalwareCategory = "aolExploit"
	WindowsMalwareCategory_Backdoor                   WindowsMalwareCategory = "backdoor"
	WindowsMalwareCategory_Behavior                   WindowsMalwareCategory = "behavior"
	WindowsMalwareCategory_BrowserModifier            WindowsMalwareCategory = "browserModifier"
	WindowsMalwareCategory_BrowserPlugin              WindowsMalwareCategory = "browserPlugin"
	WindowsMalwareCategory_Cookie                     WindowsMalwareCategory = "cookie"
	WindowsMalwareCategory_Dialer                     WindowsMalwareCategory = "dialer"
	WindowsMalwareCategory_EmailFlooder               WindowsMalwareCategory = "emailFlooder"
	WindowsMalwareCategory_EnterpriseUnwantedSoftware WindowsMalwareCategory = "enterpriseUnwantedSoftware"
	WindowsMalwareCategory_Exploit                    WindowsMalwareCategory = "exploit"
	WindowsMalwareCategory_FilesharingProgram         WindowsMalwareCategory = "filesharingProgram"
	WindowsMalwareCategory_HipsRule                   WindowsMalwareCategory = "hipsRule"
	WindowsMalwareCategory_HostileActiveXControl      WindowsMalwareCategory = "hostileActiveXControl"
	WindowsMalwareCategory_IcqExploit                 WindowsMalwareCategory = "icqExploit"
	WindowsMalwareCategory_Invalid                    WindowsMalwareCategory = "invalid"
	WindowsMalwareCategory_JokeProgram                WindowsMalwareCategory = "jokeProgram"
	WindowsMalwareCategory_Keylogger                  WindowsMalwareCategory = "keylogger"
	WindowsMalwareCategory_Known                      WindowsMalwareCategory = "known"
	WindowsMalwareCategory_MalwareCreationTool        WindowsMalwareCategory = "malwareCreationTool"
	WindowsMalwareCategory_MonitoringSoftware         WindowsMalwareCategory = "monitoringSoftware"
	WindowsMalwareCategory_Nuker                      WindowsMalwareCategory = "nuker"
	WindowsMalwareCategory_PasswordStealer            WindowsMalwareCategory = "passwordStealer"
	WindowsMalwareCategory_Policy                     WindowsMalwareCategory = "policy"
	WindowsMalwareCategory_PotentialUnwantedSoftware  WindowsMalwareCategory = "potentialUnwantedSoftware"
	WindowsMalwareCategory_Ransom                     WindowsMalwareCategory = "ransom"
	WindowsMalwareCategory_RemoteAccessTrojan         WindowsMalwareCategory = "remoteAccessTrojan"
	WindowsMalwareCategory_RemoteControlSoftware      WindowsMalwareCategory = "remote_Control_Software"
	WindowsMalwareCategory_SecurityDisabler           WindowsMalwareCategory = "securityDisabler"
	WindowsMalwareCategory_SettingsModifier           WindowsMalwareCategory = "settingsModifier"
	WindowsMalwareCategory_SoftwareBundler            WindowsMalwareCategory = "softwareBundler"
	WindowsMalwareCategory_Spp                        WindowsMalwareCategory = "spp"
	WindowsMalwareCategory_Spyware                    WindowsMalwareCategory = "spyware"
	WindowsMalwareCategory_StealthNotifier            WindowsMalwareCategory = "stealthNotifier"
	WindowsMalwareCategory_Tool                       WindowsMalwareCategory = "tool"
	WindowsMalwareCategory_ToolBar                    WindowsMalwareCategory = "toolBar"
	WindowsMalwareCategory_Trojan                     WindowsMalwareCategory = "trojan"
	WindowsMalwareCategory_TrojanDenialOfService      WindowsMalwareCategory = "trojanDenialOfService"
	WindowsMalwareCategory_TrojanDownloader           WindowsMalwareCategory = "trojanDownloader"
	WindowsMalwareCategory_TrojanDropper              WindowsMalwareCategory = "trojanDropper"
	WindowsMalwareCategory_TrojanFtp                  WindowsMalwareCategory = "trojanFtp"
	WindowsMalwareCategory_TrojanMassMailer           WindowsMalwareCategory = "trojanMassMailer"
	WindowsMalwareCategory_TrojanMonitoringSoftware   WindowsMalwareCategory = "trojanMonitoringSoftware"
	WindowsMalwareCategory_TrojanProxyServer          WindowsMalwareCategory = "trojanProxyServer"
	WindowsMalwareCategory_TrojanTelnet               WindowsMalwareCategory = "trojanTelnet"
	WindowsMalwareCategory_Unknown                    WindowsMalwareCategory = "unknown"
	WindowsMalwareCategory_Virus                      WindowsMalwareCategory = "virus"
	WindowsMalwareCategory_Vulnerability              WindowsMalwareCategory = "vulnerability"
	WindowsMalwareCategory_Worm                       WindowsMalwareCategory = "worm"
)

func PossibleValuesForWindowsMalwareCategory() []string {
	return []string{
		string(WindowsMalwareCategory_Adware),
		string(WindowsMalwareCategory_AolExploit),
		string(WindowsMalwareCategory_Backdoor),
		string(WindowsMalwareCategory_Behavior),
		string(WindowsMalwareCategory_BrowserModifier),
		string(WindowsMalwareCategory_BrowserPlugin),
		string(WindowsMalwareCategory_Cookie),
		string(WindowsMalwareCategory_Dialer),
		string(WindowsMalwareCategory_EmailFlooder),
		string(WindowsMalwareCategory_EnterpriseUnwantedSoftware),
		string(WindowsMalwareCategory_Exploit),
		string(WindowsMalwareCategory_FilesharingProgram),
		string(WindowsMalwareCategory_HipsRule),
		string(WindowsMalwareCategory_HostileActiveXControl),
		string(WindowsMalwareCategory_IcqExploit),
		string(WindowsMalwareCategory_Invalid),
		string(WindowsMalwareCategory_JokeProgram),
		string(WindowsMalwareCategory_Keylogger),
		string(WindowsMalwareCategory_Known),
		string(WindowsMalwareCategory_MalwareCreationTool),
		string(WindowsMalwareCategory_MonitoringSoftware),
		string(WindowsMalwareCategory_Nuker),
		string(WindowsMalwareCategory_PasswordStealer),
		string(WindowsMalwareCategory_Policy),
		string(WindowsMalwareCategory_PotentialUnwantedSoftware),
		string(WindowsMalwareCategory_Ransom),
		string(WindowsMalwareCategory_RemoteAccessTrojan),
		string(WindowsMalwareCategory_RemoteControlSoftware),
		string(WindowsMalwareCategory_SecurityDisabler),
		string(WindowsMalwareCategory_SettingsModifier),
		string(WindowsMalwareCategory_SoftwareBundler),
		string(WindowsMalwareCategory_Spp),
		string(WindowsMalwareCategory_Spyware),
		string(WindowsMalwareCategory_StealthNotifier),
		string(WindowsMalwareCategory_Tool),
		string(WindowsMalwareCategory_ToolBar),
		string(WindowsMalwareCategory_Trojan),
		string(WindowsMalwareCategory_TrojanDenialOfService),
		string(WindowsMalwareCategory_TrojanDownloader),
		string(WindowsMalwareCategory_TrojanDropper),
		string(WindowsMalwareCategory_TrojanFtp),
		string(WindowsMalwareCategory_TrojanMassMailer),
		string(WindowsMalwareCategory_TrojanMonitoringSoftware),
		string(WindowsMalwareCategory_TrojanProxyServer),
		string(WindowsMalwareCategory_TrojanTelnet),
		string(WindowsMalwareCategory_Unknown),
		string(WindowsMalwareCategory_Virus),
		string(WindowsMalwareCategory_Vulnerability),
		string(WindowsMalwareCategory_Worm),
	}
}

func (s *WindowsMalwareCategory) UnmarshalJSON(bytes []byte) error {
	var decoded string
	if err := json.Unmarshal(bytes, &decoded); err != nil {
		return fmt.Errorf("unmarshaling: %+v", err)
	}
	out, err := parseWindowsMalwareCategory(decoded)
	if err != nil {
		return fmt.Errorf("parsing %q: %+v", decoded, err)
	}
	*s = *out
	return nil
}

func parseWindowsMalwareCategory(input string) (*WindowsMalwareCategory, error) {
	vals := map[string]WindowsMalwareCategory{
		"adware":                     WindowsMalwareCategory_Adware,
		"aolexploit":                 WindowsMalwareCategory_AolExploit,
		"backdoor":                   WindowsMalwareCategory_Backdoor,
		"behavior":                   WindowsMalwareCategory_Behavior,
		"browsermodifier":            WindowsMalwareCategory_BrowserModifier,
		"browserplugin":              WindowsMalwareCategory_BrowserPlugin,
		"cookie":                     WindowsMalwareCategory_Cookie,
		"dialer":                     WindowsMalwareCategory_Dialer,
		"emailflooder":               WindowsMalwareCategory_EmailFlooder,
		"enterpriseunwantedsoftware": WindowsMalwareCategory_EnterpriseUnwantedSoftware,
		"exploit":                    WindowsMalwareCategory_Exploit,
		"filesharingprogram":         WindowsMalwareCategory_FilesharingProgram,
		"hipsrule":                   WindowsMalwareCategory_HipsRule,
		"hostileactivexcontrol":      WindowsMalwareCategory_HostileActiveXControl,
		"icqexploit":                 WindowsMalwareCategory_IcqExploit,
		"invalid":                    WindowsMalwareCategory_Invalid,
		"jokeprogram":                WindowsMalwareCategory_JokeProgram,
		"keylogger":                  WindowsMalwareCategory_Keylogger,
		"known":                      WindowsMalwareCategory_Known,
		"malwarecreationtool":        WindowsMalwareCategory_MalwareCreationTool,
		"monitoringsoftware":         WindowsMalwareCategory_MonitoringSoftware,
		"nuker":                      WindowsMalwareCategory_Nuker,
		"passwordstealer":            WindowsMalwareCategory_PasswordStealer,
		"policy":                     WindowsMalwareCategory_Policy,
		"potentialunwantedsoftware":  WindowsMalwareCategory_PotentialUnwantedSoftware,
		"ransom":                     WindowsMalwareCategory_Ransom,
		"remoteaccesstrojan":         WindowsMalwareCategory_RemoteAccessTrojan,
		"remote_control_software":    WindowsMalwareCategory_RemoteControlSoftware,
		"securitydisabler":           WindowsMalwareCategory_SecurityDisabler,
		"settingsmodifier":           WindowsMalwareCategory_SettingsModifier,
		"softwarebundler":            WindowsMalwareCategory_SoftwareBundler,
		"spp":                        WindowsMalwareCategory_Spp,
		"spyware":                    WindowsMalwareCategory_Spyware,
		"stealthnotifier":            WindowsMalwareCategory_StealthNotifier,
		"tool":                       WindowsMalwareCategory_Tool,
		"toolbar":                    WindowsMalwareCategory_ToolBar,
		"trojan":                     WindowsMalwareCategory_Trojan,
		"trojandenialofservice":      WindowsMalwareCategory_TrojanDenialOfService,
		"trojandownloader":           WindowsMalwareCategory_TrojanDownloader,
		"trojandropper":              WindowsMalwareCategory_TrojanDropper,
		"trojanftp":                  WindowsMalwareCategory_TrojanFtp,
		"trojanmassmailer":           WindowsMalwareCategory_TrojanMassMailer,
		"trojanmonitoringsoftware":   WindowsMalwareCategory_TrojanMonitoringSoftware,
		"trojanproxyserver":          WindowsMalwareCategory_TrojanProxyServer,
		"trojantelnet":               WindowsMalwareCategory_TrojanTelnet,
		"unknown":                    WindowsMalwareCategory_Unknown,
		"virus":                      WindowsMalwareCategory_Virus,
		"vulnerability":              WindowsMalwareCategory_Vulnerability,
		"worm":                       WindowsMalwareCategory_Worm,
	}
	if v, ok := vals[strings.ToLower(input)]; ok {
		return &v, nil
	}

	// otherwise presume it's an undefined value and best-effort it
	out := WindowsMalwareCategory(input)
	return &out, nil
}
